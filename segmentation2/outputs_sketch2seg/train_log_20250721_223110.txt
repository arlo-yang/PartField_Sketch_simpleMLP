2025-07-21 22:31:10,872 INFO: Start training with args: Namespace(data_dir='data/img', out_dir='./outputs_sketch2seg', batch_size=12, lr=0.0001, num_epochs=70, num_workers=20, log_interval=10, val_interval=1, resume='', features=128)
2025-07-21 22:31:10,930 INFO: Using device: cuda
2025-07-21 22:31:11,060 INFO: Using SketchSegmentUNet with base_features=128
2025-07-21 22:31:11,971 INFO: Model parameters: 124,133,249
2025-07-21 22:31:12,168 INFO: No checkpoint found; training from scratch.
2025-07-21 22:31:20,324 INFO: [Train] Ep[1/70] Step[10/443] Loss:0.7217
2025-07-21 22:31:26,493 INFO: [Train] Ep[1/70] Step[20/443] Loss:0.6802
2025-07-21 22:31:32,670 INFO: [Train] Ep[1/70] Step[30/443] Loss:0.6620
2025-07-21 22:31:38,832 INFO: [Train] Ep[1/70] Step[40/443] Loss:0.6459
2025-07-21 22:31:45,009 INFO: [Train] Ep[1/70] Step[50/443] Loss:0.6325
2025-07-21 22:31:51,181 INFO: [Train] Ep[1/70] Step[60/443] Loss:0.6209
2025-07-21 22:31:57,348 INFO: [Train] Ep[1/70] Step[70/443] Loss:0.6081
2025-07-21 22:32:03,522 INFO: [Train] Ep[1/70] Step[80/443] Loss:0.5962
2025-07-21 22:32:09,695 INFO: [Train] Ep[1/70] Step[90/443] Loss:0.5863
2025-07-21 22:32:15,874 INFO: [Train] Ep[1/70] Step[100/443] Loss:0.5758
2025-07-21 22:32:22,045 INFO: [Train] Ep[1/70] Step[110/443] Loss:0.5673
2025-07-21 22:32:28,226 INFO: [Train] Ep[1/70] Step[120/443] Loss:0.5608
2025-07-21 22:32:34,403 INFO: [Train] Ep[1/70] Step[130/443] Loss:0.5541
2025-07-21 22:32:40,578 INFO: [Train] Ep[1/70] Step[140/443] Loss:0.5486
2025-07-21 22:32:46,756 INFO: [Train] Ep[1/70] Step[150/443] Loss:0.5429
2025-07-21 22:32:52,930 INFO: [Train] Ep[1/70] Step[160/443] Loss:0.5380
2025-07-21 22:32:59,112 INFO: [Train] Ep[1/70] Step[170/443] Loss:0.5332
2025-07-21 22:33:05,282 INFO: [Train] Ep[1/70] Step[180/443] Loss:0.5279
2025-07-21 22:33:11,454 INFO: [Train] Ep[1/70] Step[190/443] Loss:0.5232
2025-07-21 22:33:17,631 INFO: [Train] Ep[1/70] Step[200/443] Loss:0.5194
2025-07-21 22:33:23,811 INFO: [Train] Ep[1/70] Step[210/443] Loss:0.5154
2025-07-21 22:33:29,992 INFO: [Train] Ep[1/70] Step[220/443] Loss:0.5110
2025-07-21 22:33:36,173 INFO: [Train] Ep[1/70] Step[230/443] Loss:0.5074
2025-07-21 22:33:42,358 INFO: [Train] Ep[1/70] Step[240/443] Loss:0.5039
2025-07-21 22:33:48,541 INFO: [Train] Ep[1/70] Step[250/443] Loss:0.5008
2025-07-21 22:33:54,719 INFO: [Train] Ep[1/70] Step[260/443] Loss:0.4975
2025-07-21 22:34:00,899 INFO: [Train] Ep[1/70] Step[270/443] Loss:0.4943
2025-07-21 22:34:07,088 INFO: [Train] Ep[1/70] Step[280/443] Loss:0.4917
2025-07-21 22:34:13,263 INFO: [Train] Ep[1/70] Step[290/443] Loss:0.4884
2025-07-21 22:34:19,444 INFO: [Train] Ep[1/70] Step[300/443] Loss:0.4850
2025-07-21 22:34:25,624 INFO: [Train] Ep[1/70] Step[310/443] Loss:0.4823
2025-07-21 22:34:31,802 INFO: [Train] Ep[1/70] Step[320/443] Loss:0.4795
2025-07-21 22:34:37,988 INFO: [Train] Ep[1/70] Step[330/443] Loss:0.4770
2025-07-21 22:34:44,173 INFO: [Train] Ep[1/70] Step[340/443] Loss:0.4740
2025-07-21 22:34:50,353 INFO: [Train] Ep[1/70] Step[350/443] Loss:0.4716
2025-07-21 22:34:56,548 INFO: [Train] Ep[1/70] Step[360/443] Loss:0.4692
2025-07-21 22:35:02,736 INFO: [Train] Ep[1/70] Step[370/443] Loss:0.4668
2025-07-21 22:35:08,919 INFO: [Train] Ep[1/70] Step[380/443] Loss:0.4643
2025-07-21 22:35:15,099 INFO: [Train] Ep[1/70] Step[390/443] Loss:0.4617
2025-07-21 22:35:21,278 INFO: [Train] Ep[1/70] Step[400/443] Loss:0.4592
2025-07-21 22:35:27,463 INFO: [Train] Ep[1/70] Step[410/443] Loss:0.4570
2025-07-21 22:35:33,638 INFO: [Train] Ep[1/70] Step[420/443] Loss:0.4549
2025-07-21 22:35:39,822 INFO: [Train] Ep[1/70] Step[430/443] Loss:0.4527
2025-07-21 22:35:46,004 INFO: [Train] Ep[1/70] Step[440/443] Loss:0.4501
2025-07-21 22:38:40,497 INFO: [Val] Ep[1/70] Loss:0.4080 IoU:0.3626 Acc:0.9391 Prec:0.3689 Rec:0.9745
2025-07-21 22:38:42,669 INFO: Saved best model (ep 1, val_loss 0.4080)
2025-07-21 22:38:50,325 INFO: [Train] Ep[2/70] Step[10/443] Loss:0.3489
2025-07-21 22:38:56,497 INFO: [Train] Ep[2/70] Step[20/443] Loss:0.3501
2025-07-21 22:39:02,688 INFO: [Train] Ep[2/70] Step[30/443] Loss:0.3501
2025-07-21 22:39:08,851 INFO: [Train] Ep[2/70] Step[40/443] Loss:0.3510
2025-07-21 22:39:15,022 INFO: [Train] Ep[2/70] Step[50/443] Loss:0.3460
2025-07-21 22:39:21,199 INFO: [Train] Ep[2/70] Step[60/443] Loss:0.3477
2025-07-21 22:39:27,374 INFO: [Train] Ep[2/70] Step[70/443] Loss:0.3477
2025-07-21 22:39:33,551 INFO: [Train] Ep[2/70] Step[80/443] Loss:0.3465
2025-07-21 22:39:39,724 INFO: [Train] Ep[2/70] Step[90/443] Loss:0.3465
2025-07-21 22:39:45,898 INFO: [Train] Ep[2/70] Step[100/443] Loss:0.3438
2025-07-21 22:39:52,073 INFO: [Train] Ep[2/70] Step[110/443] Loss:0.3422
2025-07-21 22:39:58,252 INFO: [Train] Ep[2/70] Step[120/443] Loss:0.3417
2025-07-21 22:40:04,431 INFO: [Train] Ep[2/70] Step[130/443] Loss:0.3398
2025-07-21 22:40:10,608 INFO: [Train] Ep[2/70] Step[140/443] Loss:0.3390
2025-07-21 22:40:16,785 INFO: [Train] Ep[2/70] Step[150/443] Loss:0.3370
2025-07-21 22:40:22,965 INFO: [Train] Ep[2/70] Step[160/443] Loss:0.3360
2025-07-21 22:40:29,148 INFO: [Train] Ep[2/70] Step[170/443] Loss:0.3353
2025-07-21 22:40:35,323 INFO: [Train] Ep[2/70] Step[180/443] Loss:0.3330
2025-07-21 22:40:41,499 INFO: [Train] Ep[2/70] Step[190/443] Loss:0.3325
2025-07-21 22:40:47,679 INFO: [Train] Ep[2/70] Step[200/443] Loss:0.3312
2025-07-21 22:40:53,862 INFO: [Train] Ep[2/70] Step[210/443] Loss:0.3308
2025-07-21 22:41:00,046 INFO: [Train] Ep[2/70] Step[220/443] Loss:0.3302
2025-07-21 22:41:06,219 INFO: [Train] Ep[2/70] Step[230/443] Loss:0.3295
2025-07-21 22:41:12,401 INFO: [Train] Ep[2/70] Step[240/443] Loss:0.3286
2025-07-21 22:41:18,579 INFO: [Train] Ep[2/70] Step[250/443] Loss:0.3274
2025-07-21 22:41:24,756 INFO: [Train] Ep[2/70] Step[260/443] Loss:0.3265
2025-07-21 22:41:30,931 INFO: [Train] Ep[2/70] Step[270/443] Loss:0.3255
2025-07-21 22:41:37,112 INFO: [Train] Ep[2/70] Step[280/443] Loss:0.3247
2025-07-21 22:41:43,295 INFO: [Train] Ep[2/70] Step[290/443] Loss:0.3239
2025-07-21 22:41:49,470 INFO: [Train] Ep[2/70] Step[300/443] Loss:0.3227
2025-07-21 22:41:55,647 INFO: [Train] Ep[2/70] Step[310/443] Loss:0.3215
2025-07-21 22:42:01,825 INFO: [Train] Ep[2/70] Step[320/443] Loss:0.3211
2025-07-21 22:42:08,014 INFO: [Train] Ep[2/70] Step[330/443] Loss:0.3203
2025-07-21 22:42:14,196 INFO: [Train] Ep[2/70] Step[340/443] Loss:0.3195
2025-07-21 22:42:20,371 INFO: [Train] Ep[2/70] Step[350/443] Loss:0.3191
2025-07-21 22:42:26,553 INFO: [Train] Ep[2/70] Step[360/443] Loss:0.3181
2025-07-21 22:42:32,733 INFO: [Train] Ep[2/70] Step[370/443] Loss:0.3173
2025-07-21 22:42:38,914 INFO: [Train] Ep[2/70] Step[380/443] Loss:0.3170
2025-07-21 22:42:45,090 INFO: [Train] Ep[2/70] Step[390/443] Loss:0.3160
2025-07-21 22:42:51,263 INFO: [Train] Ep[2/70] Step[400/443] Loss:0.3150
2025-07-21 22:42:57,448 INFO: [Train] Ep[2/70] Step[410/443] Loss:0.3139
2025-07-21 22:43:03,621 INFO: [Train] Ep[2/70] Step[420/443] Loss:0.3131
2025-07-21 22:43:09,805 INFO: [Train] Ep[2/70] Step[430/443] Loss:0.3128
2025-07-21 22:43:15,984 INFO: [Train] Ep[2/70] Step[440/443] Loss:0.3119
2025-07-21 22:46:10,440 INFO: [Val] Ep[2/70] Loss:0.3053 IoU:0.4172 Acc:0.9702 Prec:0.5531 Rec:0.7305
2025-07-21 22:46:12,703 INFO: Saved best model (ep 2, val_loss 0.3053)
2025-07-21 22:46:20,323 INFO: [Train] Ep[3/70] Step[10/443] Loss:0.2802
2025-07-21 22:46:26,497 INFO: [Train] Ep[3/70] Step[20/443] Loss:0.2677
2025-07-21 22:46:32,680 INFO: [Train] Ep[3/70] Step[30/443] Loss:0.2681
2025-07-21 22:46:38,840 INFO: [Train] Ep[3/70] Step[40/443] Loss:0.2665
2025-07-21 22:46:45,011 INFO: [Train] Ep[3/70] Step[50/443] Loss:0.2674
2025-07-21 22:46:51,184 INFO: [Train] Ep[3/70] Step[60/443] Loss:0.2659
2025-07-21 22:46:57,366 INFO: [Train] Ep[3/70] Step[70/443] Loss:0.2682
2025-07-21 22:47:03,549 INFO: [Train] Ep[3/70] Step[80/443] Loss:0.2701
2025-07-21 22:47:09,730 INFO: [Train] Ep[3/70] Step[90/443] Loss:0.2693
2025-07-21 22:47:15,910 INFO: [Train] Ep[3/70] Step[100/443] Loss:0.2694
2025-07-21 22:47:22,093 INFO: [Train] Ep[3/70] Step[110/443] Loss:0.2695
2025-07-21 22:47:28,282 INFO: [Train] Ep[3/70] Step[120/443] Loss:0.2689
2025-07-21 22:47:34,457 INFO: [Train] Ep[3/70] Step[130/443] Loss:0.2688
2025-07-21 22:47:40,637 INFO: [Train] Ep[3/70] Step[140/443] Loss:0.2697
2025-07-21 22:47:46,809 INFO: [Train] Ep[3/70] Step[150/443] Loss:0.2692
2025-07-21 22:47:52,984 INFO: [Train] Ep[3/70] Step[160/443] Loss:0.2689
2025-07-21 22:47:59,162 INFO: [Train] Ep[3/70] Step[170/443] Loss:0.2687
2025-07-21 22:48:05,334 INFO: [Train] Ep[3/70] Step[180/443] Loss:0.2686
2025-07-21 22:48:11,509 INFO: [Train] Ep[3/70] Step[190/443] Loss:0.2679
2025-07-21 22:48:17,685 INFO: [Train] Ep[3/70] Step[200/443] Loss:0.2677
2025-07-21 22:48:23,860 INFO: [Train] Ep[3/70] Step[210/443] Loss:0.2678
2025-07-21 22:48:30,037 INFO: [Train] Ep[3/70] Step[220/443] Loss:0.2672
2025-07-21 22:48:36,210 INFO: [Train] Ep[3/70] Step[230/443] Loss:0.2670
2025-07-21 22:48:42,382 INFO: [Train] Ep[3/70] Step[240/443] Loss:0.2664
2025-07-21 22:48:48,561 INFO: [Train] Ep[3/70] Step[250/443] Loss:0.2664
2025-07-21 22:48:54,738 INFO: [Train] Ep[3/70] Step[260/443] Loss:0.2667
2025-07-21 22:49:00,917 INFO: [Train] Ep[3/70] Step[270/443] Loss:0.2658
2025-07-21 22:49:07,093 INFO: [Train] Ep[3/70] Step[280/443] Loss:0.2658
2025-07-21 22:49:13,277 INFO: [Train] Ep[3/70] Step[290/443] Loss:0.2657
2025-07-21 22:49:19,451 INFO: [Train] Ep[3/70] Step[300/443] Loss:0.2654
2025-07-21 22:49:25,630 INFO: [Train] Ep[3/70] Step[310/443] Loss:0.2652
2025-07-21 22:49:31,809 INFO: [Train] Ep[3/70] Step[320/443] Loss:0.2649
2025-07-21 22:49:37,996 INFO: [Train] Ep[3/70] Step[330/443] Loss:0.2643
2025-07-21 22:49:44,175 INFO: [Train] Ep[3/70] Step[340/443] Loss:0.2645
2025-07-21 22:49:50,356 INFO: [Train] Ep[3/70] Step[350/443] Loss:0.2646
2025-07-21 22:49:56,531 INFO: [Train] Ep[3/70] Step[360/443] Loss:0.2641
2025-07-21 22:50:02,709 INFO: [Train] Ep[3/70] Step[370/443] Loss:0.2638
2025-07-21 22:50:08,891 INFO: [Train] Ep[3/70] Step[380/443] Loss:0.2639
2025-07-21 22:50:15,068 INFO: [Train] Ep[3/70] Step[390/443] Loss:0.2635
2025-07-21 22:50:21,245 INFO: [Train] Ep[3/70] Step[400/443] Loss:0.2630
2025-07-21 22:50:27,427 INFO: [Train] Ep[3/70] Step[410/443] Loss:0.2631
2025-07-21 22:50:33,607 INFO: [Train] Ep[3/70] Step[420/443] Loss:0.2632
2025-07-21 22:50:39,780 INFO: [Train] Ep[3/70] Step[430/443] Loss:0.2630
2025-07-21 22:50:45,956 INFO: [Train] Ep[3/70] Step[440/443] Loss:0.2629
2025-07-21 22:53:40,099 INFO: [Val] Ep[3/70] Loss:0.2593 IoU:0.4679 Acc:0.9754 Prec:0.6229 Rec:0.7145
2025-07-21 22:53:42,678 INFO: Saved best model (ep 3, val_loss 0.2593)
2025-07-21 22:53:50,412 INFO: [Train] Ep[4/70] Step[10/443] Loss:0.2543
2025-07-21 22:53:56,594 INFO: [Train] Ep[4/70] Step[20/443] Loss:0.2466
2025-07-21 22:54:02,779 INFO: [Train] Ep[4/70] Step[30/443] Loss:0.2609
2025-07-21 22:54:08,957 INFO: [Train] Ep[4/70] Step[40/443] Loss:0.2539
2025-07-21 22:54:15,134 INFO: [Train] Ep[4/70] Step[50/443] Loss:0.2543
2025-07-21 22:54:21,314 INFO: [Train] Ep[4/70] Step[60/443] Loss:0.2548
2025-07-21 22:54:27,492 INFO: [Train] Ep[4/70] Step[70/443] Loss:0.2552
2025-07-21 22:54:33,667 INFO: [Train] Ep[4/70] Step[80/443] Loss:0.2544
2025-07-21 22:54:39,837 INFO: [Train] Ep[4/70] Step[90/443] Loss:0.2533
2025-07-21 22:54:46,016 INFO: [Train] Ep[4/70] Step[100/443] Loss:0.2522
2025-07-21 22:54:52,196 INFO: [Train] Ep[4/70] Step[110/443] Loss:0.2524
2025-07-21 22:54:58,379 INFO: [Train] Ep[4/70] Step[120/443] Loss:0.2509
2025-07-21 22:55:04,552 INFO: [Train] Ep[4/70] Step[130/443] Loss:0.2497
2025-07-21 22:55:10,724 INFO: [Train] Ep[4/70] Step[140/443] Loss:0.2487
2025-07-21 22:55:16,905 INFO: [Train] Ep[4/70] Step[150/443] Loss:0.2480
2025-07-21 22:55:23,083 INFO: [Train] Ep[4/70] Step[160/443] Loss:0.2482
2025-07-21 22:55:29,257 INFO: [Train] Ep[4/70] Step[170/443] Loss:0.2481
2025-07-21 22:55:35,432 INFO: [Train] Ep[4/70] Step[180/443] Loss:0.2476
2025-07-21 22:55:41,618 INFO: [Train] Ep[4/70] Step[190/443] Loss:0.2467
2025-07-21 22:55:47,794 INFO: [Train] Ep[4/70] Step[200/443] Loss:0.2464
2025-07-21 22:55:53,968 INFO: [Train] Ep[4/70] Step[210/443] Loss:0.2468
2025-07-21 22:56:00,146 INFO: [Train] Ep[4/70] Step[220/443] Loss:0.2467
2025-07-21 22:56:06,326 INFO: [Train] Ep[4/70] Step[230/443] Loss:0.2464
2025-07-21 22:56:12,507 INFO: [Train] Ep[4/70] Step[240/443] Loss:0.2460
2025-07-21 22:56:18,686 INFO: [Train] Ep[4/70] Step[250/443] Loss:0.2455
2025-07-21 22:56:24,863 INFO: [Train] Ep[4/70] Step[260/443] Loss:0.2455
2025-07-21 22:56:31,044 INFO: [Train] Ep[4/70] Step[270/443] Loss:0.2454
2025-07-21 22:56:37,221 INFO: [Train] Ep[4/70] Step[280/443] Loss:0.2451
2025-07-21 22:56:43,407 INFO: [Train] Ep[4/70] Step[290/443] Loss:0.2447
2025-07-21 22:56:49,585 INFO: [Train] Ep[4/70] Step[300/443] Loss:0.2441
2025-07-21 22:56:55,765 INFO: [Train] Ep[4/70] Step[310/443] Loss:0.2436
2025-07-21 22:57:01,941 INFO: [Train] Ep[4/70] Step[320/443] Loss:0.2432
2025-07-21 22:57:08,122 INFO: [Train] Ep[4/70] Step[330/443] Loss:0.2430
2025-07-21 22:57:14,300 INFO: [Train] Ep[4/70] Step[340/443] Loss:0.2426
2025-07-21 22:57:20,476 INFO: [Train] Ep[4/70] Step[350/443] Loss:0.2426
2025-07-21 22:57:26,656 INFO: [Train] Ep[4/70] Step[360/443] Loss:0.2425
2025-07-21 22:57:32,835 INFO: [Train] Ep[4/70] Step[370/443] Loss:0.2424
2025-07-21 22:57:39,016 INFO: [Train] Ep[4/70] Step[380/443] Loss:0.2422
2025-07-21 22:57:45,194 INFO: [Train] Ep[4/70] Step[390/443] Loss:0.2416
2025-07-21 22:57:51,375 INFO: [Train] Ep[4/70] Step[400/443] Loss:0.2409
2025-07-21 22:57:57,555 INFO: [Train] Ep[4/70] Step[410/443] Loss:0.2406
2025-07-21 22:58:03,727 INFO: [Train] Ep[4/70] Step[420/443] Loss:0.2404
2025-07-21 22:58:09,907 INFO: [Train] Ep[4/70] Step[430/443] Loss:0.2403
2025-07-21 22:58:16,086 INFO: [Train] Ep[4/70] Step[440/443] Loss:0.2398
